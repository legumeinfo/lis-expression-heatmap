var lisExpressionHeatmap=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t){e.exports=window.React},function(e,t){e.exports=window.ReactDOM},function(e,t,r){"use strict";r.r(t),r.d(t,"main",(function(){return S}));var n=r(0),a=r.n(n),l=r(1),i=r.n(l);var o=function(){return a.a.createElement("div",{className:"loading-container"},a.a.createElement("div",null,a.a.createElement("span",null),a.a.createElement("span",null),a.a.createElement("span",null),a.a.createElement("span",null)))};var u=function(e){return{from:"ExpressionValue",select:["value","feature.name","sample.num","sample.name","sample.description","sample.genotype","sample.tissue","sample.treatment","sample.replicateGroup","sample.source.primaryIdentifier"],orderBy:[{path:"sample.source.primaryIdentifier",direction:"ASC"},{path:"feature.name",direction:"ASC"},{path:"sample.num",direction:"ASC"}],where:[{path:"feature.id",op:"ONE OF",values:e.featureIds}]}};function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var s=function(e){return function(){return e}},f=a.a.memo((function(e){var t=e.render,r=void 0===t?s(null):t,n=e.style,l=void 0===n?s({}):n,i=e.ratio,o=e.posX,u=e.posY,f=e.square,d=void 0!==f&&f,p=e.height,m=void 0===p?"2rem":p,v=e.value,b=e.onClick;return a.a.createElement("div",{onClick:function(){return(b||s({}))(o,u)},style:c({border:"1px solid #fff",borderWidth:"1px 1px 0 0",textAlign:"center",color:"rgb(0, 0, 0, "+(i/2+.4)+")",overflow:"hidden",boxSizing:"border-box",flexGrow:d?0:1,flexBasis:d?m:0,flexShrink:0,height:m,lineHeight:m,borderRadius:"4px",fontSize:".8rem",cursor:b?"pointer":"initial",background:"rgb(12, 160, 44, "+(i+.05)+")"},l(o,u,i))},r(o,u,v))}));function d(e){var t=e.children,r=e.reverse,n=void 0!==r&&r;return a.a.createElement("div",{style:{display:"flex",flexDirection:n?"row-reverse":"row",justifyContent:n?"flex-end":"initial"}},t)}function p(e){var t=e.labels,r=e.xLabelsStyle,n=void 0===r?function(){return{}}:r,l=e.height,i=e.square,o=void 0!==i&&i,u=100/t.length+"%";return a.a.createElement("div",{style:{display:"flex",textAlign:"center"}},t.map((function(e,t){return a.a.createElement("div",{key:e+"-"+t,style:c({padding:"0.2rem 0",boxSizing:"border-box",flexGrow:o?"initial":1,overflow:"hidden",flexShrink:1,flexBasis:o?l:u,width:o?l:u},n(t))},e)})))}function m(e){var t=e.children,r=e.grow,n=void 0!==r&&r,l=e.reverse,i=void 0!==l&&l;return a.a.createElement("div",{style:{display:"flex",flexDirection:i?"column-reverse":"column",flexGrow:n?1:0}},t)}function v(e){var t=e.labels,r=e.height,n=e.yLabelsStyle,l=void 0===n?function(){return{}}:n,i=e.reverse,o=void 0!==i&&i;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",textAlign:o?"left":"right"}},t.map((function(e,t){return a.a.createElement("div",{key:e,style:c({boxSizing:"border-box",padding:"0 0.2rem",lineHeight:r},l(t))},e)})))}function b(e){var t,r=e.xLabelHeight,n=e.isXLabelReverse,l=e.children,i=((t={})[n?"marginBottom":"marginTop"]=r+"px",t);return a.a.createElement("div",{style:i},l)}var y=function(e){var t,r,l,i,o,u=e.data,c=e.xLabels,s=e.yLabels,y=e.xLabelsPos,h=void 0===y?"top":y,g=e.yLabelsPos,x=void 0===g?"left":g,E=e.square,S=void 0!==E&&E,O=e.cellHeight,j=void 0===O?"2px":O,w=e.xLabelsStyle,L=e.yLabelsStyle,k=e.cellStyle,C=e.cellRender,A=e.onClick,M=(t=22,r=a.a.useRef(null),l=a.a.useState(t),i=l[0],o=l[1],a.a.useEffect((function(){if(r.current){var e=(r.current||{}).clientHeight;o(e)}}),[]),[i,r]),P=M[0],I=M[1],R=function(e){var t=e.reduce((function(e,t){return[].concat(t,e)}),[]),r=Math.max.apply(Math,t);return[Math.min.apply(Math,t),r]}(u),H=R[0],z=R[1]-H,N="bottom"===h,q="right"===x;return Object(n.createElement)(d,{reverse:q},s&&Object(n.createElement)(b,{xLabelHeight:P,isXLabelReverse:N},Object(n.createElement)(v,{reverse:q,labels:s,height:j,yLabelsStyle:L})),Object(n.createElement)(m,{reverse:N,grow:!S},Object(n.createElement)("div",{ref:I},c&&Object(n.createElement)(p,{labels:c,xLabelsStyle:w,height:j,square:S})),Object(n.createElement)(m,null,u.map((function(e,t){return Object(n.createElement)(d,{key:t},e.map((function(e,r){return Object(n.createElement)(f,{key:t+"-"+r,posX:t,posY:r,onClick:A,value:e,height:j,square:S,render:C,style:k,ratio:(e-H)/z})})))})))))};function h(e){for(var t=e.features,r=e.data,n=e.sampleData,l=n.nums,i=n.names,o=n.genotypes,u=n.tissues,c=n.treatments,s=[],f=0;f<l.length;f++){var d=i[f];o[f]&&(d=d+":"+o[f]),u[f]&&(d=d+":"+u[f]),c[f]&&(d=d+":"+c[f]),s.push(d)}return a.a.createElement("div",null,a.a.createElement("div",{style:{"font-family":"sans-serif","font-size":"12px","font-style":"italic","padding-left":"80px"}},"Mouse over cell to see data."),a.a.createElement(y,{data:r,xLabels:l,yLabels:t,square:!0,cellRender:function(e,r,n){return a.a.createElement("div",{title:"".concat(s[r]," | ").concat(t[e]," = ").concat(n," TPM")},n)},xLabelsStyle:function(){return{fontFamily:"sans-serif",fontSize:"10px",color:"black",borderTop:"1px solid black"}},yLabelsStyle:function(){return{fontFamily:"sans-serif",fontSize:"12px",color:"black",borderRight:"1px solid black"}},cellStyle:function(e,t,r){return{background:"rgb(12, 160, 44, ".concat(r,")"),color:"transparent",border:"1px solid black",borderRadius:"0"}},cellHeight:"15px",xLabelsPos:"bottom",yLabelsPos:"left"}))}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,a,l=[],i=!0,o=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(o)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e){var t=e.serviceUrl,r=e.entity,l=(e.config,r.value),i=g(Object(n.useState)(null),2),c=i[0],s=i[1],f=g(Object(n.useState)(null),2),d=f[0],p=f[1],m=g(Object(n.useState)(null),2),v=m[0],b=m[1],y=g(Object(n.useState)(null),2),x=y[0],E=y[1],S=g(Object(n.useState)(null),2),O=S[0],j=S[1],w=g(Object(n.useState)(null),2),L=w[0],k=w[1],C=g(Object(n.useState)(null),2),A=C[0],M=C[1];return Object(n.useEffect)((function(){(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:imjs;return new Promise((function(n,a){new r.Service({root:t}).records(u({featureIds:e})).then((function(e){e&&e.length?n(e):a("No data found!")})).catch(a)}))})(l,t).then((function(e){var t=function(e){var t=[];return e.forEach((function(e){var r=e.sample.source.primaryIdentifier;t.includes(r)||t.push(r)})),t}(e),r=function(e){var t=[];return e.forEach((function(e){var r=e.feature.name;t.includes(r)||t.push(r)})),t}(e);p(e),b(t),E(r)})).catch((function(){s("No expression data found!")}))}),[]),c?a.a.createElement("div",{className:"rootContainer error"},c):a.a.createElement("div",{className:"rootContainer"},v&&a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement("select",{name:"sourceIndex",onChange:function(e){var t,r,n,a,l,i,o,u=e.target.value;u<0?(j(null),k(null),M(null)):(j(v[u]),k(function(e,t){var r=[],n=[],a="";return e.forEach((function(e){var l=Number(e.value),i=(e.sample.num,e.sample.name,e.sample.source.primaryIdentifier),o=e.feature.name;i==t&&(o!=a&&(""!=a&&(r.push(n),n=[]),a=o),n.push(l))})),r.push(n),r}(d,v[u])),M((t=d,r=v[u],n=[],a=[],l=[],i=[],o=[],t.forEach((function(e){var t=e.sample.source.primaryIdentifier,u=e.sample.num;t!=r||n.includes(u)||(n.push(u),a.push(e.sample.name),l.push(e.sample.genotype),i.push(e.sample.tissue),o.push(e.sample.treatment))})),{nums:n,names:a,genotypes:l,tissues:i,treatments:o})))}},a.a.createElement("option",{key:-1},"Select expression experiment"),v.map((function(e,t){return a.a.createElement("option",{key:t,value:t},e)})))),v&&x&&O&&A&&L&&a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement(h,{features:x,data:L,sampleData:A})),!v&&a.a.createElement(o,null))}function S(e,t,r,n,l){if(n||(n={}),!(e&&t&&r&&n&&l))throw new Error("Call main with correct signature");i.a.render(a.a.createElement(E,{serviceUrl:t.root,entity:r.Gene,config:l}),e)}}]);