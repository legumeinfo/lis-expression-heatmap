var lisExpressionHeatmap=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=window.React},function(e,t){e.exports=window.ReactDOM},function(e,t,n){"use strict";n.r(t),n.d(t,"main",(function(){return S}));var r=n(0),a=n.n(r),l=n(1),i=n.n(l);var o=function(){return a.a.createElement("div",{className:"loading-container"},a.a.createElement("div",null,a.a.createElement("span",null),a.a.createElement("span",null),a.a.createElement("span",null),a.a.createElement("span",null)))};var u=function(e){return{from:"ExpressionValue",select:["value","feature.name","sample.num","sample.name","sample.description","sample.genotype","sample.tissue","sample.treatment","sample.replicateGroup","sample.source.primaryIdentifier","sample.source.synopsis"],orderBy:[{path:"sample.source.primaryIdentifier",direction:"ASC"},{path:"feature.name",direction:"ASC"},{path:"sample.num",direction:"ASC"}],where:[{path:"feature.id",op:"ONE OF",values:e.featureIds}]}};function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var c=function(e){return function(){return e}},f=a.a.memo((function(e){var t=e.render,n=void 0===t?c(null):t,r=e.style,l=void 0===r?c({}):r,i=e.ratio,o=e.posX,u=e.posY,f=e.square,m=void 0!==f&&f,p=e.height,d=void 0===p?"2rem":p,v=e.value,y=e.onClick;return a.a.createElement("div",{onClick:function(){return(y||c({}))(o,u)},style:s({border:"1px solid #fff",borderWidth:"1px 1px 0 0",textAlign:"center",color:"rgb(0, 0, 0, "+(i/2+.4)+")",overflow:"hidden",boxSizing:"border-box",flexGrow:m?0:1,flexBasis:m?d:0,flexShrink:0,height:d,lineHeight:d,borderRadius:"4px",fontSize:".8rem",cursor:y?"pointer":"initial",background:"rgb(12, 160, 44, "+(i+.05)+")"},l(o,u,i))},n(o,u,v))}));function m(e){var t=e.children,n=e.reverse,r=void 0!==n&&n;return a.a.createElement("div",{style:{display:"flex",flexDirection:r?"row-reverse":"row",justifyContent:r?"flex-end":"initial"}},t)}function p(e){var t=e.labels,n=e.xLabelsStyle,r=void 0===n?function(){return{}}:n,l=e.height,i=e.square,o=void 0!==i&&i,u=100/t.length+"%";return a.a.createElement("div",{style:{display:"flex",textAlign:"center"}},t.map((function(e,t){return a.a.createElement("div",{key:e+"-"+t,style:s({padding:"0.2rem 0",boxSizing:"border-box",flexGrow:o?"initial":1,overflow:"hidden",flexShrink:1,flexBasis:o?l:u,width:o?l:u},r(t))},e)})))}function d(e){var t=e.children,n=e.grow,r=void 0!==n&&n,l=e.reverse,i=void 0!==l&&l;return a.a.createElement("div",{style:{display:"flex",flexDirection:i?"column-reverse":"column",flexGrow:r?1:0}},t)}function v(e){var t=e.labels,n=e.height,r=e.yLabelsStyle,l=void 0===r?function(){return{}}:r,i=e.reverse,o=void 0!==i&&i;return a.a.createElement("div",{style:{display:"flex",flexDirection:"column",textAlign:o?"left":"right"}},t.map((function(e,t){return a.a.createElement("div",{key:e,style:s({boxSizing:"border-box",padding:"0 0.2rem",lineHeight:n},l(t))},e)})))}function y(e){var t,n=e.xLabelHeight,r=e.isXLabelReverse,l=e.children,i=((t={})[r?"marginBottom":"marginTop"]=n+"px",t);return a.a.createElement("div",{style:i},l)}var b=function(e){var t,n,l,i,o,u=e.data,s=e.xLabels,c=e.yLabels,b=e.xLabelsPos,h=void 0===b?"top":b,g=e.yLabelsPos,x=void 0===g?"left":g,E=e.square,S=void 0!==E&&E,O=e.cellHeight,j=void 0===O?"2px":O,w=e.xLabelsStyle,L=e.yLabelsStyle,k=e.cellStyle,C=e.cellRender,I=e.onClick,P=(t=22,n=a.a.useRef(null),l=a.a.useState(t),i=l[0],o=l[1],a.a.useEffect((function(){if(n.current){var e=(n.current||{}).clientHeight;o(e)}}),[]),[i,n]),M=P[0],A=P[1],R=function(e){var t=e.reduce((function(e,t){return[].concat(t,e)}),[]),n=Math.max.apply(Math,t);return[Math.min.apply(Math,t),n]}(u),N=R[0],H=R[1]-N,T="bottom"===h,z="right"===x;return Object(r.createElement)(m,{reverse:z},c&&Object(r.createElement)(y,{xLabelHeight:M,isXLabelReverse:T},Object(r.createElement)(v,{reverse:z,labels:c,height:j,yLabelsStyle:L})),Object(r.createElement)(d,{reverse:T,grow:!S},Object(r.createElement)("div",{ref:A},s&&Object(r.createElement)(p,{labels:s,xLabelsStyle:w,height:j,square:S})),Object(r.createElement)(d,null,u.map((function(e,t){return Object(r.createElement)(m,{key:t},e.map((function(e,n){return Object(r.createElement)(f,{key:t+"-"+n,posX:t,posY:n,onClick:I,value:e,height:j,square:S,render:C,style:k,ratio:(e-N)/H})})))})))))};function h(e){for(var t=e.features,n=e.data,r=e.sampleData,l=r.nums,i=r.names,o=r.genotypes,u=r.tissues,s=r.treatments,c=[],f=0;f<l.length;f++){var m=i[f];o[f]&&(m=m+":"+o[f]),u[f]&&(m=m+":"+u[f]),s[f]&&(m=m+":"+s[f]),c.push(m)}return a.a.createElement("div",null,a.a.createElement("div",{style:{"font-family":"sans-serif","font-size":"12px","font-style":"italic","padding-left":"80px"}},"Mouse over cell to see data."),a.a.createElement(b,{data:n,xLabels:l,yLabels:t,square:!0,cellRender:function(e,n,r){return a.a.createElement("div",{title:"".concat(c[n]," | ").concat(t[e]," = ").concat(r," TPM")},r)},xLabelsStyle:function(){return{fontFamily:"sans-serif",fontSize:"10px",color:"black",borderTop:"1px solid black"}},yLabelsStyle:function(){return{fontFamily:"sans-serif",fontSize:"12px",color:"black",borderRight:"1px solid black"}},cellStyle:function(e,t,n){return{background:"rgb(12, 160, 44, ".concat(n,")"),color:"transparent",border:"1px solid black",borderRadius:"0"}},cellHeight:"15px",xLabelsPos:"bottom",yLabelsPos:"left"}))}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,l=[],i=!0,o=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(o)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t=e.serviceUrl,n=e.entity,l=(e.config,n.value),i=g(Object(r.useState)(null),2),s=i[0],c=i[1],f=g(Object(r.useState)(null),2),m=f[0],p=f[1],d=g(Object(r.useState)(null),2),v=d[0],y=d[1],b=g(Object(r.useState)(null),2),x=b[0],E=b[1],S=g(Object(r.useState)(null),2),O=S[0],j=S[1],w=g(Object(r.useState)(null),2),L=w[0],k=w[1],C=g(Object(r.useState)(null),2),I=C[0],P=C[1];return Object(r.useEffect)((function(){(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:imjs;return new Promise((function(r,a){new n.Service({root:t}).records(u({featureIds:e})).then((function(e){e&&e.length?r(e):a("No data found!")})).catch(a)}))})(l,t).then((function(e){p(e),y(function(e){var t=[],n=[];return e.forEach((function(e){var r=e.sample.source.primaryIdentifier;n.includes(r)||(n.push(r),t.push({name:e.sample.source.primaryIdentifier,synopsis:e.sample.source.synopsis}))})),t}(e)),E(function(e){var t=[];return e.forEach((function(e){var n=e.feature.name;t.includes(n)||t.push(n)})),t}(e))})).catch((function(){c("No expression data found!")}))}),[]),s?a.a.createElement("div",{className:"rootContainer error"},s):a.a.createElement("div",{className:"rootContainer"},v&&a.a.createElement("div",{className:"selector"},a.a.createElement("select",{name:"sourceIndex",onChange:function(e){var t,n,r,a,l,i,o,u=e.target.value;u<0?(j(null),k(null),P(null)):(j(v[u]),k(function(e,t){var n=[],r=[],a="";return e.forEach((function(e){var l=Number(e.value),i=(e.sample.num,e.sample.name,e.sample.source.primaryIdentifier),o=e.feature.name;i==t.name&&(o!=a&&(""!=a&&(n.push(r),r=[]),a=o),r.push(l))})),n.push(r),n}(m,v[u])),P((t=m,n=v[u],r=[],a=[],l=[],i=[],o=[],t.forEach((function(e){var t=e.sample.source.primaryIdentifier,u=e.sample.num;t!=n.name||r.includes(u)||(r.push(u),a.push(e.sample.name),l.push(e.sample.genotype),i.push(e.sample.tissue),o.push(e.sample.treatment))})),{nums:r,names:a,genotypes:l,tissues:i,treatments:o})))}},a.a.createElement("option",{key:-1,value:-1},"--- SELECT EXPRESSION EXPERIMENT ---"),v.map((function(e,t){return a.a.createElement("option",{key:t,value:t},e.name)})))),O&&a.a.createElement("div",{className:"synopsis"},O.synopsis),v&&x&&O&&I&&L&&a.a.createElement("div",{style:{padding:"10px"}},a.a.createElement(h,{features:x,data:L,sampleData:I})),!v&&a.a.createElement(o,null))}function S(e,t,n,r,l){if(r||(r={}),!(e&&t&&n&&r&&l))throw new Error("Call main with correct signature");i.a.render(a.a.createElement(E,{serviceUrl:t.root,entity:n.Gene,config:l}),e)}}]);